{"version":3,"sources":["assets/script/core-game/category_list.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import * as _G from '../system/all_modules';\nconst { _, $ } = _G;\n\nconst FRAME_SIZE = 263;\nconst ORG_FRAME_SIZE = 800;\nconst FRAME_SCALE = FRAME_SIZE / ORG_FRAME_SIZE;\n\nconst FRAME_SIZE_V2 = 284;\nconst FRAME_SCALE_V2 = FRAME_SIZE_V2 / ORG_FRAME_SIZE;\n\nexport const categoryList = {\n   containerNode: null as cc.Node,\n   containerNodeV2: null as cc.Node,\n   colliderNode: null as cc.Node,\n\n   frameNodeArr: [],\n\n   init() {\n      this.containerNode = cc.find('Canvas/play_area/scrollview_master/view/content/category_lists');\n      this.containerNodeV2 = cc.find('Canvas/play_area/scrollview_master/view/content/category_lists_v2');\n      this.colliderNode = cc.find('Canvas/play_area/visible_frame_collider');\n\n      this.containerNode.active = !_G.user.isVersionV2;\n      this.containerNodeV2.active = _G.user.isVersionV2;\n\n      if (!_G.user.isVersionV2) this.renderList();\n      else this.renderListV2();\n      _G.resources.addFrameLoadCallback((catName, frameName) => this.onFrameLoaded(catName, frameName));\n\n      this.setupVisibleFrameCollider();\n   },\n\n\n   onFrameLoaded(catName, frameName) {\n      // _.log(` onFrameLoaded >> catName=${catName}, frameName=${frameName} `);\n      let frameCellNode;\n\n      if (_G.user.isVersionV2) {\n         frameCellNode = this.containerNodeV2.children.find(node => node.categoryName == catName && node.name == frameName);\n      } else {\n         const catContainerNode = cc.find(catName, this.containerNode)\n         const scrollViewContent = cc.find('scrollview/view/content', catContainerNode);\n         frameCellNode = cc.find(frameName, scrollViewContent);\n      }\n      if (!frameCellNode) return _.log(` onFrameLoaded (${catName}, ${frameName}) >>  frameCellNode = ${frameCellNode} `);\n\n      frameCellNode.isTextureLoaded = true;\n      const frameNode = cc.find('frame', frameCellNode);\n      _G.utilsUI.setNodeSprite(frameNode, _G.resources.frameSprites[catName][frameName]);\n\n      // fx fade in to smoothly show\n      const frameCover = cc.find('frame_cover', frameCellNode);\n      cc.tween(frameCover).to(0.3, { opacity: 0 }).start();\n   },\n\n   setupVisibleFrameCollider() {\n      _.setTimeout(() => {\n         this.colliderNode.active = true;\n         this.colliderNode.height = this.colliderNode.getComponent(cc.BoxCollider).size.height = cc.winSize.height;\n         // this.colliderNode.getComponent(cc.BoxCollider).size.width = 300;\n         // this.colliderNode.getComponent(cc.BoxCollider).size.height = 300;\n      }, 100);\n   },\n\n\n   renderList() {\n      const scrollViewMaster = cc.find('Canvas/play_area/scrollview_master');\n      const scrollViewMasterComp = scrollViewMaster.getComponent('NestableScrollView_Outer');\n\n      const sampleNode = cc.find('Canvas/sample_nodes/sample_category_row');\n      const sampleFrameNode = cc.find('Canvas/sample_nodes/sample_frame_cell');\n      sampleFrameNode.opacity = 0;\n\n      _G.levelManager.categoryNameArr.map(catName => {\n         const newRowNode = _.copyNode(sampleNode, this.containerNode);\n         newRowNode.name = catName;\n         newRowNode.opacity = 0; // reduce drawcall. Will appear when touching visible collider\n         scrollViewMasterComp.m_InnerScrollViews.push(cc.find('scrollview', newRowNode).getComponent('NestableScrollView_Inner'))\n         // _G.utilsUI.fillChildLabelByPath(newRowNode, 'header_bg/label_category_list_header_name', catName);\n         const labelCatName = cc.find('header_bg/label_category_list_header_name', newRowNode);\n         labelCatName.localizeData = catName;\n\n         const categoryInfo = _G.levelManager.categoryArr.find(catInfo => catInfo.id == catName);\n         if (!categoryInfo) return;\n\n         const scrollViewContent = cc.find('scrollview/view/content', newRowNode);\n         categoryInfo.frameArr.map(frameInfo => {\n            const newFrameCellNode = _.copyNode(sampleFrameNode, scrollViewContent);\n            this.frameNodeArr.push(newFrameCellNode);\n            newFrameCellNode.name = frameInfo.name;\n            newFrameCellNode.categoryName = catName;\n            const frameNode = cc.find('frame', newFrameCellNode);\n\n            const frameTexture = _G.resources.frameSprites[catName][frameInfo.name];\n            if (frameTexture) _G.utilsUI.setNodeSprite(frameNode, frameTexture);\n\n            newFrameCellNode.buttonCompZoomScale = 0.9;\n            _G.utilsUI.makeBubbleButton(newFrameCellNode, () => _G.gameMechanic.previewGame(catName, frameInfo.name, 3, 3, true));\n         });\n      });\n\n      scrollViewMasterComp.reloadInnerScrollViews();\n      this.setupAllFrameAvatars();\n      _.waitToRun(() => this.updateAllIconCheckeds(), 'playedGames', _G.user);\n\n   },\n\n\n   renderListV2() {\n      const sampleFrameNode = cc.find('Canvas/sample_nodes/sample_frame_cell_v2');\n      sampleFrameNode.opacity = 0;\n\n      _G.levelManager.categoryNameArr.map(catName => {\n         const categoryInfo = _G.levelManager.categoryArr.find(catInfo => catInfo.id == catName);\n         if (!categoryInfo) return;\n\n         categoryInfo.frameArr.map(frameInfo => {\n            // zIndexArr.push(i++);\n            const newFrameCellNode = _.copyNode(sampleFrameNode, this.containerNodeV2);\n            this.frameNodeArr.push(newFrameCellNode);\n            newFrameCellNode.name = frameInfo.name;\n            newFrameCellNode.categoryName = catName;\n            const frameNode = cc.find('frame', newFrameCellNode);\n\n            const frameTexture = _G.resources.frameSprites[catName][frameInfo.name];\n            if (frameTexture) _G.utilsUI.setNodeSprite(frameNode, frameTexture);\n\n            newFrameCellNode.buttonCompZoomScale = 0.9;\n            _G.utilsUI.makeBubbleButton(newFrameCellNode, () => {\n               _G.gameMechanic.previewGame(catName, frameInfo.name, 1, 1, true);\n               this.sortCategoryV2Randomly();\n               _G.interAd.checkToShowInterAd();\n            });\n         });\n      });\n\n      _.waitToRun(() => this.sortCategoryV2Randomly(), 'playedGames', _G.user);\n\n      this.setupAllFrameAvatars();\n      _.waitToRun(() => this.updateAllIconCheckeds(), 'playedGames', _G.user);\n   },\n\n\n   // random order but newFrame on top, played-frames at bottom\n   sortCategoryV2Randomly() {\n      const frameNodeToScore = node => _G.user.playedGames[`${node.categoryName}_${node.name}`] ? 2 : 1;\n      this.frameNodeArr.sort((nodeA, nodeB) => (frameNodeToScore(nodeA) - frameNodeToScore(nodeB)) || (_.random() > 0.5 ? 1 : -1));\n      this.frameNodeArr.map((node, i) => node.zIndex = i);\n   },\n\n\n   setupAllFrameAvatars() {\n      const setupFrameCellNode = (frameCellNode) => {\n         const frameNode = cc.find('frame', frameCellNode);\n         const avatarNode = cc.find('mask/avatar', frameCellNode);\n         _G.utilsUI.setNodeSprite(avatarNode, _G.mapVisual.avatarSpriteFrame);\n         const frameScale = _G.user.isVersionV2 ? FRAME_SCALE_V2 : FRAME_SCALE;\n         const frameSize = _G.user.isVersionV2 ? FRAME_SIZE_V2 : FRAME_SIZE;\n         _G.mapVisual.setAvatar(frameCellNode.categoryName, frameCellNode.name, frameNode, avatarNode, frameScale, frameSize);\n      }\n\n      if (_G.user.isVersionV2)\n         this.containerNodeV2.children.map((frameCellNode) => setupFrameCellNode(frameCellNode))\n      else {\n         this.containerNode.children.map(catContainerNode => {\n            const scrollViewContent = cc.find('scrollview/view/content', catContainerNode);\n            scrollViewContent.children.map((frameCellNode) => setupFrameCellNode(frameCellNode));\n         });\n      }\n   },\n\n\n   updateAllIconCheckeds() {\n      const setupIconChecked = (frameCellNode) => {\n         cc.find('icon_checked', frameCellNode).active = _G.user.playedGames[frameCellNode.categoryName + '_' + frameCellNode.name];\n      }\n\n      if (_G.user.isVersionV2)\n         this.containerNodeV2.children.map(frameCellNode => setupIconChecked(frameCellNode));\n      else this.containerNode.children.map(catContainerNode => {\n         const scrollViewContent = cc.find('scrollview/view/content', catContainerNode);\n         scrollViewContent.children.map(frameCellNode => setupIconChecked(frameCellNode));\n      });\n   },\n\n\n\n}"]}